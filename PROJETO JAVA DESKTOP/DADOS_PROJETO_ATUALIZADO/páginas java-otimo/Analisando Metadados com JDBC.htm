
<!-- saved from url=(0033)http://www.guj.com.br/articles/24 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">


	




<title>GUJ - Analisando Metadados com JDBC</title>
<link href="./Analisando Metadados com JDBC_files/guj3.css" media="screen" rel="stylesheet" type="text/css">

<!-- OAS SETUP begin -->
<script language="JavaScript">
<!--
//configuration
OAS_url = 'http://media.realmedia.com.br/RealMedia/ads/';
OAS_listpos = 'Top,Right,x01,x04';
OAS_query = '';
OAS_sitepage = 'guj/internas';
//end of configuration
OAS_version = 10;
OAS_rn = '001234567890'; OAS_rns = '1234567890';
OAS_rn = new String (Math.random()); OAS_rns = OAS_rn.substring (2, 11);
function OAS_NORMAL(pos) {
	document.write('<A HREF="' + OAS_url + 'click_nx.ads/' + OAS_sitepage + '/1' + OAS_rns + '@' + OAS_listpos + '!' + pos + OAS_query + '" TARGET=_top>');
	document.write('<IMG SRC="' + OAS_url + 'adstream_nx.ads/' + OAS_sitepage + '/1' + OAS_rns + '@' + OAS_listpos + '!' + pos + OAS_query + '" BORDER=0></A>');
}
//-->
</script>
<script language="JavaScript">
<!--
OAS_version = 11;
if (navigator.userAgent.indexOf('Mozilla/3') != -1)
OAS_version = 10;
if (OAS_version >= 11)
document.write('<SCR'+ 'IPT LANGUAGE=JavaScript1.1 SRC="' + OAS_url + 'adstream_mjx.ads/' + OAS_sitepage + '/1' + OAS_rns + '@' + OAS_listpos + OAS_query + '"></SC'+'RIPT>');
//-->
</script><script language="JavaScript1.1" src="./Analisando Metadados com JDBC_files/1544383189@Top,Right,x01,x04"></script><script language="JavaScript">
<!-- 
document.write('')
function OAS_AD(pos) {
if (OAS_version >= 11)
	OAS_RICH(pos);
else
	OAS_NORMAL(pos);
}
//-->
</script>
<!-- OAS SETUP end -->
<!--[if IE]>
<link href="/stylesheets/guj3-ie.css?20090222" media="screen" rel="stylesheet" type="text/css" />
<![endif]-->
<script type="text/javascript" src="./Analisando Metadados com JDBC_files/jquery-1.3.1.min.js"></script>
<script type="text/javascript" src="./Analisando Metadados com JDBC_files/jquery.dimensions.min.js"></script>
<script type="text/javascript">
$().ready(function() {
	$("#returnPath").val(document.location);
});
</script>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style><style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style><style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style><style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style><link rel="stylesheet" type="text/css" href="chrome-extension://knnjalkmmdbjmbnkdolelamkbnjoohbe/css/about.css"></head><style type="text/css" id="CWToolbarStyle">html { padding-top: 34px !important;}</style>

<body>
  <div id="header">
    <div class="container1">
    	<div id="banner">
			<!-- OAS AD 'Top' begin -->
			<script language="JavaScript">
			<!--
			OAS_AD('Top');
			//-->
			</script><!-- begin ad tag -->
<script type="text/javascript">
//<![CDATA[
ord=Math.random()*10000000000000000;
document.write('<script type="text/javascript" src="http://ad.doubleclick.net/adj/guj/;fiap=gujsuper;sz=728x90;click0=http://media.realmedia.com.br/RealMedia/ads/click_lx.ads/guj/internas/L12/768046350/Top/rmlanetwork/110602_fiapmba_guj/fiapmba_guj_home_int_super_110602.html/76556850786b3433424b5141416b3576?;ord=768046350' + ord + '?"><\/script>');
//]]>
</script><script type="text/javascript" src="./Analisando Metadados com JDBC_files/;fiap=gujsuper;sz=728x90"></script>
<!-- Copyright DoubleClick Inc., All rights reserved. -->
<!-- This code was autogenerated @ Mon Jun 27 11:14:10 EDT 2011 -->
<script src="./Analisando Metadados com JDBC_files/flashwrite_1_2.js"></script>
  
<div style="padding:0px;border:0px;margin:0px;overflow:hidden;width:728px;height=90px;position:relative"> <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="FLASH_AD" width="728" height="90"><param name="movie" value="http://s0.2mdn.net/2824562/2011_05_super_banner_mba.swf"><param name="quality" value="high"><param name="bgcolor" value="#"><param name="wmode" value="opaque"><param name="AllowScriptAccess" value="never"><embed src="http://s0.2mdn.net/2824562/2011_05_super_banner_mba.swf" quality="high" wmode="opaque" swliveconnect="TRUE" width="728" height="90" bgcolor="#" type="application/x-shockwave-flash" allowscriptaccess="never"></object> <div style="z-index:9999;padding:0px;border:0px;margin:0px;overflow:hidden;width:728px;height=90px;position:absolute;top:0px;left:0px"><a target="_blank" href="http://ad.doubleclick.net/click%3Bh%3Dv8/3b56/17/bf/%2a/y%3B242120798%3B0-0%3B1%3B50082471%3B3454-728/90%3B42819652/42837439/1%3B%3B~sscs%3D%3fhttp://media.realmedia.com.br/RealMedia/ads/click_lx.ads/guj/internas/L12/768046350/Top/rmlanetwork/110602_fiapmba_guj/fiapmba_guj_home_int_super_110602.html/76556850786b3433424b5141416b3576?http://www.fiap.com.br/mba2011/index.html?utm_source=guj&utm_medium=super_banner&utm_term=neuronio-2&utm_content=inscreva-se&utm_campaign=pos2011-2"><img src="./Analisando Metadados com JDBC_files/dot.gif" border="0" width="728" height="90"></a></div></div>
<noscript>&lt;a target="_blank" href="http://ad.doubleclick.net/click%3Bh%3Dv8/3b56/17/bf/%2a/y%3B242120798%3B0-0%3B1%3B50082471%3B3454-728/90%3B42819652/42837439/1%3B%3B%7Esscs%3D%3fhttp://media.realmedia.com.br/RealMedia/ads/click_lx.ads/guj/internas/L12/768046350/Top/rmlanetwork/110602_fiapmba_guj/fiapmba_guj_home_int_super_110602.html/76556850786b3433424b5141416b3576?http://www.fiap.com.br/mba2011/index.html?utm_source=guj&amp;utm_medium=super_banner&amp;utm_term=neuronio-2&amp;utm_content=inscreva-se&amp;utm_campaign=pos2011-2"&gt;&lt;img src="http://s0.2mdn.net/2824562/2011_05_super_banner_mba.gif"  border="0" alt="" &gt;&lt;/a&gt;</noscript>
<noscript>&lt;a href="http://media.realmedia.com.br/RealMedia/ads/click_lx.ads/guj/internas/L12/768046350/Top/rmlanetwork/110602_fiapmba_guj/fiapmba_guj_home_int_super_110602.html/76556850786b3433424b5141416b3576?http://ad.doubleclick.net/jump/guj/;fiap=gujsuper;sz=728x90;ord=768046350?" target="_blank" &gt;&lt;img src="http://ad.doubleclick.net/ad/guj/;fiap=gujsuper;sz=728x90;ord=768046350?" border="0" alt="" /&gt;&lt;/a&gt;</noscript>
<!-- end ad tag --> 
			<!-- OAS AD 'Top' end -->
    	</div>
      <div class="container2">
        <a href="http://www.guj.com.br/" id="logo">GUJ</a>
        <h2>Notícias, artigos e o maior fórum brasileiro sobre Java</h2>
      </div>
    </div>
  </div>

  <div id="menu">
    <ul>
      <li class="home">
        <a href="http://www.guj.com.br/">home</a>
      </li>
      <li class="forum">
        <a href="http://www.guj.com.br/forums/list.java">fórum</a>
      </li>
      
      <li class="noticias">
        <a href="http://www.guj.com.br/noticias">notícias</a>
      </li>
      
      <li class="topics">
        <a href="http://www.guj.com.br/recentTopics/list.java">tópicos recentes</a>
      </li>
        
      <li class="empregos">
		<a href="http://www.guj.com.br/jobs">empregos</a>
      </li>
    
      <li class="artigos">
      	<a href="http://www.guj.com.br/articles">artigos</a>
      </li>
    	<!--
      <li class="blogs">
        <a href="/posts">blogs</a>
      </li>
      -->
    </ul>
    
    <form action="http://www.guj.com.br/search" id="cse-search-box" class="busca">
	    <input type="hidden" name="cx" value="partner-pub-9448585618971060:4001950301">
	    <input type="hidden" name="cof" value="FORID:10">
	    <input type="hidden" name="ie" value="UTF-8">
	    <input class="campo_rounded" type="text" name="q" size="31" tabindex="1" style="border-top-width: 1px; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-top-style: solid; border-right-style: solid; border-bottom-style: solid; border-left-style: solid; border-top-color: rgb(126, 157, 185); border-right-color: rgb(126, 157, 185); border-bottom-color: rgb(126, 157, 185); border-left-color: rgb(126, 157, 185); padding-top: 2px; padding-right: 2px; padding-bottom: 2px; padding-left: 2px; background-image: url(http://www.google.com.br/cse/intl/en/images/google_custom_search_watermark.gif); background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(255, 255, 255); background-position: 0% 50%; background-repeat: no-repeat no-repeat; ">
	    <input type="image" class="botao" style="border: 0px;" src="./Analisando Metadados com JDBC_files/botao_ok.gif" tabindex="2">
	<input name="siteurl" type="hidden" value="www.guj.com.br/articles/24"></form>

<script type="text/javascript" src="./Analisando Metadados com JDBC_files/brand"></script>
	<iframe src="./Analisando Metadados com JDBC_files/like.htm" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:200px; height:21px; position:relative; top:7px;" allowtransparency="true"></iframe>
  </div>
  
  <div id="submenu">
    <div class="container1">
      <div class="container2">
          
      	
      		
	      	  <a id="myprofile" class="mainmenu" href="http://www.guj.com.br/user/edit/132475.java"><img src="./Analisando Metadados com JDBC_files/icon_mini_profile.gif" border="0" alt="[Profile]"> MEUS DADOS</a>&nbsp; 
              <a id="privatemessages" class="mainmenu" href="http://www.guj.com.br/pm/inbox.java"><img src="./Analisando Metadados com JDBC_files/icon_mini_message.gif" border="0" alt="[Message]">
                MENSAGENS PRIVADAS (0)
              </a>&nbsp;
              <a id="mymessages" class="mainmenu" href="http://www.guj.com.br/posts/listByUser/132475.java"><img src="./Analisando Metadados com JDBC_files/icon_mini_message.gif" border="0" alt="Minhas Mensagens">
                MINHAS MENSAGENS
              </a>&nbsp;
              <a id="favorites" class="mainmenu" href="http://www.guj.com.br/bookmarks/list/132475.java"><img src="./Analisando Metadados com JDBC_files/icon_mini_message.gif" border="0" alt="Favoritos">
                   FAVORITOS
              </a>&nbsp;
            
            	
            		<a id="newsletter" class="mainmenu" href="http://www.guj.com.br/articles/24#" onclick="$(&#39;#menuNewsletter&#39;).slideToggle(&#39;slow&#39;);"><img src="./Analisando Metadados com JDBC_files/icon_mini_message.gif" border="0" alt="Favoritos"> NEWSLETTER <span class="novo">(novo)</span></a>
	      		
            
	      	  <a href="http://www.guj.com.br/user/logout.java"><img src="./Analisando Metadados com JDBC_files/icon_mini_login.gif" border="0" alt="Logout"> LOGOUT</a> 
      		
      		
      	
      </div>
    </div>
  </div>

  
	  <div id="menuNewsletter" style="">
		 <div style="float:left; margin-top:5px;">
	  		Para participar da newsletter com o e-mail <strong>jorgelferrari@gmail.com</strong>, <a href="http://www.guj.com.br/newsletter/?_method=POST&gujUserId=132475">clique aqui</a>, ou acesse <a href="http://www.guj.com.br/user/edit/132475.java">seu cadastro</a> para modificar seu e-mail.
	  	 </div>
	  	 <div style="text-align:center; float:right; padding:5px;">
	  	 	<a href="http://www.guj.com.br/articles/24#" onclick="escondeNewsletter();"><img src="./Analisando Metadados com JDBC_files/cancel_16.png" border="0"></a>
	  	 </div>
	  </div>
	  
	  
	  <script language="javascript">
		function newsletterCookieHidden() {
			return readCookie('gujNewsletterMenu')=='hidden';
		}
		
		function readCookie(name) {
			var nameEQ = name + "=";
			var ca = document.cookie.split(';');
			for(var i=0;i < ca.length;i++) {
				var c = ca[i];
				while (c.charAt(0)==' ') c = c.substring(1,c.length);
				if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
			}
			return null;
		}
		
		if (!newsletterCookieHidden()) {
			$("#menuNewsletter").attr("style","");
		}
		
		function escondeNewsletter() {
			$('#menuNewsletter').slideToggle('slow');
			if (!newsletterCookieHidden()){
				document.cookie='gujNewsletterMenu=hidden;path=/';
			}
		}
		</script>
  
  

<link href="./Analisando Metadados com JDBC_files/SyntaxHighlighter.css" media="screen" rel="stylesheet" type="text/css">
<style type="text/css">@import url(/stylesheets/tagging.css);</style>
<script src="./Analisando Metadados com JDBC_files/shCore.js" type="text/javascript"></script>
<script src="./Analisando Metadados com JDBC_files/shBrushJava.js" type="text/javascript"></script>

<script type="text/javascript">
window.onload = function () {
	dp.SyntaxHighlighter.HighlightAll('code');
}
</script>

<div id="content">
<div class="box">
<b class="spiffy"><b class="spiffy1"><b></b></b><b class="spiffy2"><b></b></b><b class="spiffy3"></b><b class="spiffy4"></b><b class="spiffy5"></b></b>
	<div class="spiffyfg inner-content">
  <span class="article">
    <h2><a href="http://www.guj.com.br/articles/24#">Analisando Metadados com JDBC</a>
    </h2>
  </span>
  
  <div class="miolo">
    <span class="data">em 11/11/2002</span>
    <span class="autor">, por <a href="mailto:adriano.marcandali@oracle.com">Adriano Marcandali</a></span>
    <br>
  
    
	    <div style="float: left; padding: 10px;">
			<script type="text/javascript"><!--
			google_ad_client = "pub-7098584793170190";
			/* GUJ Quadrado Artigos */
			google_ad_slot = "2113535366";
			google_ad_width = 300;
			google_ad_height = 250;
			//-->
			</script> 
			<script type="text/javascript" src="./Analisando Metadados com JDBC_files/show_ads.js"> 
			</script><ins style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px"><iframe allowtransparency="true" frameborder="0" height="250" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){i+=&#39;.call&#39;;setTimeout(h,0)}else if(h.match){i+=&#39;.nav&#39;;w.location.replace(h)}s.log&amp;&amp;s.log.push(i)}" scrolling="no" vspace="0" width="300" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;"></iframe></ins></ins>
		</div>
	      
	      <span class="content"><page>
<div id="subtitle"><b>Introdução</b></div>
Neste Tutorial você aprenderá a recuperar metadados de seu banco de dados, tabelas e stored procedures.

Mas, o que são metadados?

Como o próprio nome diz, Metadados são informações sobre os seus dados. Pense em metadata como um reflection do seu banco de dados!

Ex: Metadados de uma tabela são: nome das colunas, tipo de dados das colunas (VARCHAR, NUMBER), tamanho da coluna, proprietário da tabela,etc.

<div id="subtitle"><b> Motivação </b></div>
Em algumas situações é necessário se recuperar esses metadados para construirmos nossas consultas dinamicamente, pois em uma grande base de dados algumas mudanças estruturais podem ocorrer com certa frequência.

Alguns desenvolvedores constróem seus próprios frameworks utilizando as funcionalidades de recuperação de metadados do JDBC. Assim quando um Analista de Dados alterar o modelo relacional, acrescentando colunas ou alterando o tipo das mesmas, as suas aplicações não precisam sofrer manutenções.

Existem três classes que nos permitem recuperar metadados a partir do Driver JDBC, no pacote <i>java.sql</i>:

<li>DatabaseMetaData
</li><li>ResultSetMetaData
</li><li>ParameterMetaData (nova, JDBC 3.0)

<page>
<div id="subtitle"><b> A Classe DatabaseMetaData  </b></div>
A classe DatabaseMetaData é recuperada através do objeto Connection e nos permitirá recuperar metadados sobre o banco de dados em uso, objetos do banco de dados, informações sobre o Driver JDBC, privilégios de acesso, etc. Existem mais de 150 métodos disponíveis para esta classe.

Vamos então verificar como utilizar a Classe DatabaseMetaData :

<br> <div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-j"><li class="alt"><span><span class="keyword">package</span><span>&nbsp;br.com.guj;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="keyword">import</span><span>&nbsp;java.sql.*;&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;Exemplo1&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;main(String[]&nbsp;args)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;SQLException&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;registrar&nbsp;o&nbsp;Driver&nbsp;JDBC&nbsp;do&nbsp;banco&nbsp;de&nbsp;dados,&nbsp;neste&nbsp;caso&nbsp;estou&nbsp;usando&nbsp;o&nbsp;da&nbsp;Oracle</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DriverManager.registerDriver(<span class="keyword">new</span><span>&nbsp;oracle.jdbc.driver.OracleDriver());&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;String&nbsp;de&nbsp;conexao&nbsp;para&nbsp;uma&nbsp;base&nbsp;Oracle</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Connection&nbsp;conn&nbsp;=&nbsp;DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@127.0.0.1:1521:orcl"</span><span>,</span><span class="string">"scott"</span><span>,</span><span class="string">"tiger"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;recuperar&nbsp;a&nbsp;classe&nbsp;&nbsp;DatabaseMetadaData&nbsp;a&nbsp;partir&nbsp;da&nbsp;conexao&nbsp;criada</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DatabaseMetaData&nbsp;dbmd&nbsp;=&nbsp;conn.getMetaData();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println&nbsp;(&nbsp;<span class="string">"Versao&nbsp;do&nbsp;Driver&nbsp;JDBC&nbsp;=&nbsp;"</span><span>+&nbsp;dbmd.getDriverVersion());&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println&nbsp;(&nbsp;<span class="string">"Versao&nbsp;do&nbsp;Banco&nbsp;de&nbsp;Dados&nbsp;=&nbsp;"</span><span>+&nbsp;dbmd.getDatabaseProductVersion());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println&nbsp;(&nbsp;<span class="string">"Suporta&nbsp;Select&nbsp;for&nbsp;Update?&nbsp;=&nbsp;"</span><span>+&nbsp;dbmd.supportsSelectForUpdate());&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println&nbsp;(&nbsp;<span class="string">"Suporta&nbsp;Transacoes?&nbsp;=&nbsp;"</span><span>+&nbsp;dbmd.supportsTransactions());&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;retornar&nbsp;todos&nbsp;os&nbsp;schemas(usuarios)&nbsp;do&nbsp;Banco&nbsp;de&nbsp;Dados&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ResultSet&nbsp;r2&nbsp;=&nbsp;dbmd.getSchemas();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(r2.next())&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string">"SCHEMA&nbsp;DO&nbsp;BD&nbsp;=&nbsp;"</span><span>&nbsp;+&nbsp;r2.getString(</span><span class="number">1</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><textarea name="code" class="java" cols="60" rows="10" style="display: none; ">package br.com.guj;

import java.sql.*;

public class Exemplo1 {
	public static void main(String[] args) throws SQLException {
		// registrar o Driver JDBC do banco de dados, neste caso estou usando o da Oracle
		DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());

		// String de conexao para uma base Oracle
		Connection conn = DriverManager.getConnection("jdbc:oracle:thin:@127.0.0.1:1521:orcl","scott","tiger");

		// recuperar a classe  DatabaseMetadaData a partir da conexao criada
		DatabaseMetaData dbmd = conn.getMetaData();

		System.out.println ( "Versao do Driver JDBC = "+ dbmd.getDriverVersion());
		System.out.println ( "Versao do Banco de Dados = "+ dbmd.getDatabaseProductVersion());
		System.out.println ( "Suporta Select for Update? = "+ dbmd.supportsSelectForUpdate());  
		System.out.println ( "Suporta Transacoes? = "+ dbmd.supportsTransactions());

		// retornar todos os schemas(usuarios) do Banco de Dados 
		ResultSet r2 = dbmd.getSchemas();
		while (r2.next()) {
			System.out.println("SCHEMA DO BD = " + r2.getString(1));
		}
	}
}
</textarea> <br>
</page>
<page>
<div id="subtitle"><b> A Classe ResultSetMetaData </b></div>

A outra Classe que pode ser utilizada para recuperar mais metadados é a ResultSetMetaData, com um objeto dessa classe você poderá dinamicamente recuperar a quantidade de colunas de uma tabela (não estou me referindo a registros ou linhas, e sim colunas), também poderá dinamicamente descobrir o nome da coluna, seu tipo, tamanho, entre outras informações.

Neste próximo exemplo iremos utilizar a classe ResultSetMetaData para descobrirmos dinamicamente o total de colunas de uma tabela, o nome de suas colunas e o tipo das mesmas.

<br> <div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-j"><li class="alt"><span><span>&nbsp;&nbsp;...&nbsp;&nbsp;</span></span></li><li class=""><span>Statement&nbsp;stmt&nbsp;=&nbsp;conn.createStatement();&nbsp;&nbsp;</span></li><li class="alt"><span><span class="comment">//&nbsp;Tabela&nbsp;a&nbsp;ser&nbsp;analisada</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span>ResultSet&nbsp;rset&nbsp;=&nbsp;stmt.executeQuery(<span class="string">"SELECT&nbsp;*&nbsp;from&nbsp;EMP&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li class=""><span>ResultSetMetaData&nbsp;rsmd&nbsp;=&nbsp;rset.getMetaData();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;retorna&nbsp;o&nbsp;numero&nbsp;total&nbsp;de&nbsp;colunas</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">int</span><span>&nbsp;numColumns&nbsp;=&nbsp;rsmd.getColumnCount();&nbsp;&nbsp;</span></span></li><li class=""><span>System.out.println(<span class="string">"Total&nbsp;de&nbsp;Colunas&nbsp;=&nbsp;"</span><span>&nbsp;+&nbsp;numColumns);&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;loop&nbsp;para&nbsp;recuperar&nbsp;os&nbsp;metadados&nbsp;de&nbsp;cada&nbsp;coluna</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i=</span><span class="number">0</span><span>;&nbsp;i&lt;numColumns;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;System.out.print(<span class="string">"Nome&nbsp;da&nbsp;Coluna="</span><span>&nbsp;+&nbsp;rsmd.getColumnName&nbsp;(i&nbsp;+&nbsp;</span><span class="number">1</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;System.out.print(<span class="string">"&nbsp;Tipo="</span><span>&nbsp;+&nbsp;rsmd.getColumnType&nbsp;(i&nbsp;+&nbsp;</span><span class="number">1</span><span>)&nbsp;);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;System.out.print(<span class="string">"&nbsp;Nome&nbsp;do&nbsp;Tipo="</span><span>&nbsp;+&nbsp;rsmd.getColumnTypeName&nbsp;(i&nbsp;+&nbsp;</span><span class="number">1</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;System.out.print(<span class="string">"&nbsp;Tamanho="</span><span>&nbsp;+&nbsp;rsmd.getColumnDisplaySize&nbsp;(i&nbsp;+&nbsp;</span><span class="number">1</span><span>));&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string">"&nbsp;Casas&nbsp;Decimais="</span><span>&nbsp;+&nbsp;rsmd.getScale(i&nbsp;+&nbsp;</span><span class="number">1</span><span>));&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><textarea name="code" class="java" cols="60" rows="10" style="display: none; ">  ...
Statement stmt = conn.createStatement();
// Tabela a ser analisada
ResultSet rset = stmt.executeQuery("SELECT * from EMP ");
   
ResultSetMetaData rsmd = rset.getMetaData();

// retorna o numero total de colunas
int numColumns = rsmd.getColumnCount();
System.out.println("Total de Colunas = " + numColumns);

// loop para recuperar os metadados de cada coluna
for (int i=0; i&lt;numColumns; i++) {
	System.out.print("Nome da Coluna=" + rsmd.getColumnName (i + 1));
	System.out.print(" Tipo=" + rsmd.getColumnType (i + 1) );
	System.out.print(" Nome do Tipo=" + rsmd.getColumnTypeName (i + 1));
	System.out.print(" Tamanho=" + rsmd.getColumnDisplaySize (i + 1));
	System.out.println(" Casas Decimais=" + rsmd.getScale(i + 1));
}

</textarea> <br>


Você ainda pode utilizar as classes PreparedStatement ou CallableStatement para uma instância ResultSetMetaData. 

Comprove no exemplo abaixo:

<br> <div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-j"><li class="alt"><span><span>...&nbsp;&nbsp;</span></span></li><li class=""><span>PreparedStatement&nbsp;ps&nbsp;=&nbsp;conn.prepareStatement(<span class="string">"SELECT&nbsp;*&nbsp;FROM&nbsp;EMP&nbsp;where&nbsp;EMPNO&nbsp;=&nbsp;?&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>ps.setLong(<span class="number">1</span><span>,1020L);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span>ResultSetMetaData&nbsp;rsmd&nbsp;=&nbsp;ps.getMetaData();&nbsp;&nbsp;</span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="comment">//&nbsp;retorna&nbsp;o&nbsp;numero&nbsp;total&nbsp;de&nbsp;colunas</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">int</span><span>&nbsp;numColumns&nbsp;=&nbsp;rsmd.getColumnCount();&nbsp;&nbsp;</span></span></li><li class="alt"><span>System.out.println(<span class="string">"Total&nbsp;de&nbsp;Colunas&nbsp;=&nbsp;"</span><span>&nbsp;+&nbsp;numColumns);&nbsp;&nbsp;</span></span></li></ol></div><textarea name="code" class="java" cols="60" rows="10" style="display: none; ">...
PreparedStatement ps = conn.prepareStatement("SELECT * FROM EMP where EMPNO = ? ");
ps.setLong(1,1020L);

ResultSetMetaData rsmd = ps.getMetaData();

// retorna o numero total de colunas
int numColumns = rsmd.getColumnCount();
System.out.println("Total de Colunas = " + numColumns);
</textarea> <br>

</page>
<page>
<div id="subtitle"><b>A Classe ParameterMetaData </b></div>
Através da classe ParameterMetaData é possível recuperar metadados sobre os "parâmetros" de cláusulas SQL que usamos com a classe PreparedStatement.

Assim poderemos descobrir dinamicamente a quantidade de parâmetros utilizados e suas características.

Confiram no exemplo abaixo o uso da classe ParameterMetaData recuperando informações sobres os parâmetros "?" da clásula SQL.

<br> <div class="dp-highlighter"><div class="bar"><div class="tools"><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;ViewSource&#39;,this);return false;">view plain</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;PrintSource&#39;,this);return false;">print</a><a href="http://www.guj.com.br/articles/24#" onclick="dp.sh.Toolbar.Command(&#39;About&#39;,this);return false;">?</a></div></div><ol start="1" class="dp-j"><li class="alt"><span><span>PreparedStatement&nbsp;pstmt&nbsp;=&nbsp;conn.prepareStatement(</span><span class="string">"SELECT&nbsp;*&nbsp;FROM&nbsp;EMP&nbsp;WHERE&nbsp;EMPNO&nbsp;=&nbsp;?&nbsp;AND&nbsp;DEPTNO&nbsp;=&nbsp;?"</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>ParameterMetaData&nbsp;pmd&nbsp;=&nbsp;pstmt.getParameterMetaData();&nbsp;&nbsp;</span></li><li class="alt"><span>&nbsp;&nbsp;</span></li><li class=""><span><span class="comment">//&nbsp;recupera&nbsp;o&nbsp;total&nbsp;de&nbsp;parametros</span><span>&nbsp;&nbsp;</span></span></li><li class="alt"><span><span class="keyword">int</span><span>&nbsp;totalParam&nbsp;=&nbsp;pmd.getParameterCount();&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;</span></li><li class="alt"><span><span class="comment">//&nbsp;recupera&nbsp;informacoes&nbsp;sobre&nbsp;cada&nbsp;parametro</span><span>&nbsp;&nbsp;</span></span></li><li class=""><span><span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i=</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;totalParam;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li><li class="alt"><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;tipoParam&nbsp;=&nbsp;pmd.getParameterType(i+</span><span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li class=""><span>&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;nomeTipoParam&nbsp;=&nbsp;pmd.getParameterTypeName(i+<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li class="alt"><span>}&nbsp;&nbsp;</span></li></ol></div><textarea name="code" class="java" cols="60" rows="10" style="display: none; ">PreparedStatement pstmt = conn.prepareStatement("SELECT * FROM EMP WHERE EMPNO = ? AND DEPTNO = ?");
ParameterMetaData pmd = pstmt.getParameterMetaData();

// recupera o total de parametros
int totalParam = pmd.getParameterCount();

// recupera informacoes sobre cada parametro
for (int i=0; i &lt; totalParam; i++) {
	int tipoParam = pmd.getParameterType(i+1);
	String nomeTipoParam = pmd.getParameterTypeName(i+1);
}

</textarea> <br>

<div id="subtitle"><b>Resumo e conclusão</b></div>
Um objeto DatabaseMetaData é obtida através do objeto Connection e oferecerá recursos de recuperação de metadados da base de dados e da sua conexão atual, pode ser utilizada por exemplo para verificar quais os schemas(usuários) de uma base de dados, se a conexão atual possui suporte a um determinado nível de isolamente de transações, ou até mesmo qual a versão do Driver JDBC.

Um objeto ResultSetMetaData pode ser obtida através de um ResultSet previamente criado ou através das classes PreparedStatement e CallableStatement, lhe possibilitando a recuperação de metadados sobre as colunas da cláusula SQL atual, como a quantidade de colunas, nome e tipos das mesmas.

Um objeto ParameterMetaData é obtida através de um PreparedStatement, e permite que você possa recuperar metadados sobre os parâmetros usados em clausulas SQL. 

Com essas três classes é possível recuperar informações dinamicamente de uma base de dados. Alguns desenvolvedores utilizam constantemente essas três classes para criarem seu próprio framework de persistência de dados.
</page>

    

    <span class="pdf">
    
    </span>
  </li></page></span></div>
  </div>
	<b class="spiffy"><b class="spiffy5"></b><b class="spiffy4"></b><b class="spiffy3"></b><b class="spiffy2"><b></b></b><b class="spiffy1"><b></b></b></b>
</div>

</div>


<!-- OAS AD 'x01' begin -->
<script language="JavaScript">
<!--
OAS_AD('x01');
//-->
</script><a href="http://media.realmedia.com.br/RealMedia/ads/click_lx.ads/guj/internas/1269325070/x01/default/empty.gif/76556850786b3433424b5141416b3576" target="_top"><img src="./Analisando Metadados com JDBC_files/empty.gif" width="1" height="1" alt="" border="0"></a>
<!-- OAS AD 'x01' end -->

<iframe src="./Analisando Metadados com JDBC_files/ping_session.htm" height="0" width="0" frameborder="0" scrolling="no"></iframe>
  <div id="footer">
  	<p>Apoiado e desenvolvido por <a href="http://www.caelum.com.br/">Caelum Cursos Java</a> - GUJ: desde 2002 <br> Conheça também <a href="http://www.agendatech.com.br/">AgendaTech</a>, <a href="http://www.tectura.com.br/">Tectura</a>, <a href="http://www.programadorpoliglota.com.br/">Programador Poliglota</a> e <a href="http://www.infoq.com/br">InfoQ Brasil</a>&nbsp;</p>
  </div>
 
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="./Analisando Metadados com JDBC_files/ga.js" type="text/javascript"></script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-132222-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
  

<div class="SkipThisFixedPosition top-iframe-wrapper" style="width: 100%; height: 34px; position: fixed; top: 0px !important; left: 0px; z-index: 99997; "><iframe style="width:100%;height:34px;top:0px;left:0px;" src="./Analisando Metadados com JDBC_files/container.htm" scrolling="no" class="toolbarContainer" frameborder="0px" id="CWTBiframe0"></iframe></div><div id="mainContainer_CTID"><div class="fixedDiv SkipThisFixedPosition UrlGadgetsDiv" style="position: fixed; left: 0px; top: 34px !important; z-index: 2147483640; "></div><div class="fixedDiv SkipThisFixedPosition GeneralGadgetsDiv" style="position: fixed; left: 0px; top: 34px !important; z-index: 2147483640; width: 100%; "></div></div></body></html>